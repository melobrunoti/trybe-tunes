(this.webpackJsonptrybetunes=this.webpackJsonptrybetunes||[]).push([[0],{30:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(24),c=n.n(i),s=(n(30),n(3)),o=n(4),u=n(6),l=n(5),d=n(14),h=n(7),j=n(15),b=n(2),m=n.n(b),p=n(8),v=n(19),f=n(10),O=n(0),g=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(O.jsx)("div",{className:"loading",children:Object(O.jsx)("h2",{children:"Carregando..."})})}}]),n}(a.Component),x="user",k=function(e){return localStorage.setItem(x,JSON.stringify(e))},y=function(e){return function(t){setTimeout((function(){t(e)}),1500)}},S=function(){return new Promise((function(e){var t=JSON.parse(localStorage.getItem(x));null===t&&(t={}),y(t)(e)}))},N=function(e){return new Promise((function(t){k(Object(j.a)(Object(j.a)({},{name:"",email:"",image:"",description:""}),e)),y("OK")(t)}))},C=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={name:"",loading:!1},a.user=a.user.bind(Object(f.a)(a)),a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.user()}},{key:"user",value:function(){var e=Object(p.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:t=e.sent,this.setState({name:t.name,loading:!1});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.name;return e.loading?Object(O.jsx)(g,{}):Object(O.jsxs)("header",{className:"header","data-testid":"header-component",children:[Object(O.jsx)("h2",{className:"header__user","data-testid":"header-user-name",children:t}),Object(O.jsxs)("div",{className:"header__nav",children:[Object(O.jsx)(d.b,{to:"/search","data-testid":"link-to-search",className:"header__nav__link",children:"Search"}),Object(O.jsx)(d.b,{to:"/favorites","data-testid":"link-to-favorites",className:"header__nav__link",children:"Favorites"}),Object(O.jsx)(d.b,{to:"/profile","data-testid":"link-to-profile",className:"header__nav__link",children:"Profile"})]})]})}}]),n}(a.Component),_=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props,t=e.trackName,n=e.previewUrl,a=e.trackId,r=e.handleFavorite,i=e.isChecked;return Object(O.jsxs)("div",{className:"test",children:[Object(O.jsx)("span",{children:t}),Object(O.jsx)("audio",{"data-testid":"audio-component",src:n,controls:!0,children:Object(O.jsx)("track",{kind:"captions"})}),Object(O.jsxs)("label",{htmlFor:a,children:["Favorita",Object(O.jsx)("input",{type:"checkbox","data-testid":"checkbox-music-".concat(a),onChange:r,checked:i,id:a})]})]})}}]),n}(a.Component),w=function(){var e=Object(p.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://itunes.apple.com/lookup?id=".concat(t,"&entity=song"));case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,e.abrupt("return",a.results);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I="favorite_songs";JSON.parse(localStorage.getItem(I))||localStorage.setItem(I,JSON.stringify([]));var F=function(){return JSON.parse(localStorage.getItem(I))},U=function(e){return localStorage.setItem(I,JSON.stringify(e))},B=function(e){return function(t){setTimeout((function(){t(e)}),500)}},D=function(){return new Promise((function(e){var t=F();B(t)(e)}))},M=function(e){return new Promise((function(t){if(e){var n=F();U([].concat(Object(v.a)(n),[e]))}B("OK")(t)}))},P=function(e){return new Promise((function(t){var n=F();U(n.filter((function(t){return t.trackId!==e.trackId}))),B("OK")(t)}))},J=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).state={loading:!0,data:[],favoriteSongs:[]},e.getFavorites=e.getFavorites.bind(Object(f.a)(e)),e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;w(t).then((function(t){e.setState({data:Object(v.a)(t),loading:!1})})),this.getFavorites()}},{key:"handleFavorite",value:function(){var e=Object(p.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.state.favoriteSongs,this.setState({loading:!0}),!n.some((function(e){return e.trackId===t.trackId}))){e.next=7;break}return e.next=5,P(t);case 5:e.next=9;break;case 7:return e.next=9,M(t);case 9:return e.next=11,D();case 11:a=e.sent,this.setState({favoriteSongs:a,loading:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getFavorites",value:function(){var e=Object(p.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:t=e.sent,this.setState({favoriteSongs:t,loading:!1});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,a=t.data,r=t.favoriteSongs;return Object(O.jsxs)("div",{"data-testid":"page-album",children:[Object(O.jsx)(C,{}),n?Object(O.jsx)(g,{}):null,Object(O.jsxs)("div",{className:"album",children:[Object(O.jsx)("span",{"data-testid":"artist-name",children:Object(a[0]).artistName}),Object(O.jsx)("span",{"data-testid":"album-name",children:Object(a[0]).collectionName}),Object(O.jsx)("div",{className:"song",children:a.map((function(t){var n=r.some((function(e){return e.trackId===t.trackId}));return Object.keys(t).includes("trackName")?Object(O.jsx)(_,Object(j.a)(Object(j.a)({},t),{},{isChecked:n,handleFavorite:function(){return e.handleFavorite(t)}}),t.trackId):null}))})]}),")"]})}}]),n}(a.Component),E=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).state={favoriteSongs:[],loading:!1},e.getFavorites=e.getFavorites.bind(Object(f.a)(e)),e.removeMusic=e.removeMusic.bind(Object(f.a)(e)),e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.getFavorites()}},{key:"getFavorites",value:function(){var e=Object(p.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,D();case 3:t=e.sent,this.setState({favoriteSongs:t,loading:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeMusic",value:function(){var e=Object(p.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,P(t);case 3:return e.next=5,D();case 5:n=e.sent,this.setState({favoriteSongs:n,loading:!1});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,n=t.favoriteSongs,a=t.loading;return Object(O.jsxs)("div",{"data-testid":"page-favorites",children:[Object(O.jsx)(C,{}),a?Object(O.jsx)(g,{}):null,n.map((function(t){var a=n.some((function(e){return e.trackId===t.trackId}));return Object(O.jsx)(_,Object(j.a)(Object(j.a)({},t),{},{handleFavorite:function(){return e.removeMusic(t)},isChecked:a}),t.trackId)}))]})}}]),n}(a.Component),T=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).handleChange=function(t){var n=t.target.value;e.setState({name:n})},e.state={name:"",loading:!1,redirect:!1},e.submitButton=e.submitButton.bind(Object(f.a)(e)),e}return Object(o.a)(n,[{key:"submitButton",value:function(){var e=Object(p.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.name,this.setState({loading:!0}),e.next=4,N({name:t});case 4:this.setState({loading:!1,redirect:!0});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.name,n=e.redirect;return e.loading?Object(O.jsx)(g,{}):n?Object(O.jsx)(h.a,{to:"/search"}):Object(O.jsx)("div",{className:"login-page","data-testid":"page-login",children:Object(O.jsxs)("div",{className:"login",children:[Object(O.jsx)("h1",{className:"login__title",children:"TrybeTunes"}),Object(O.jsx)("input",{className:"login__input",placeholder:"name",type:"text","data-testid":"login-name-input",onChange:this.handleChange}),Object(O.jsx)("button",{className:"login__button",type:"button","data-testid":"login-submit-button",disabled:t.length<3,onClick:this.submitButton,children:"Entrar"})]})})}}]),n}(a.Component),A=function(){var e=Object(p.a)(m.a.mark((function e(t){var n,a,r,i,c,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=encodeURI(t).replaceAll("%20","+"),a="https://itunes.apple.com/search?entity=album&term=".concat(n,"&attribute=allArtistTerm"),e.next=4,fetch(a);case 4:return r=e.sent,e.next=7,r.json();case 7:return i=e.sent,c=i.results,s=c.map((function(e){return{artistId:e.artistId,artistName:e.artistName,collectionId:e.collectionId,collectionName:e.collectionName,collectionPrice:e.collectionPrice,artworkUrl100:e.artworkUrl100,releaseDate:e.releaseDate,trackCount:e.trackCount}})),e.abrupt("return",s);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props.album,t=e.artistName,n=e.collectionId,a=e.collectionName,r=e.artworkUrl100;return Object(O.jsxs)("div",{className:"card",children:[Object(O.jsx)("img",{className:"card__img",src:r,alt:a}),Object(O.jsx)("div",{children:a}),Object(O.jsx)("div",{children:t}),Object(O.jsx)(d.b,{className:"card__link",to:"album/".concat(n),"data-testid":"link-to-album-".concat(n),children:"See more"})]})}}]),n}(a.Component),q=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).handleChange=function(t){var n=t.target.value;e.setState({searchInput:n})},e.state={search:"",searchInput:"",loading:!1,request:!1,albums:[]},e.onSearch=e.onSearch.bind(Object(f.a)(e)),e}return Object(o.a)(n,[{key:"onSearch",value:function(){var e=Object(p.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.searchInput,this.setState({loading:!0,search:t}),e.next=4,A(t);case 4:n=e.sent,this.setState({albums:n,loading:!1,request:!0,searchInput:""});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderAlbums",value:function(){var e=this.state,t=e.albums,n=e.search;return 0===t.length?Object(O.jsx)("p",{children:"Nenhum \xe1lbum foi encontrado"}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("h2",{className:"results",children:"Resultado de \xe1lbuns de: ".concat(n)}),Object(O.jsxs)("div",{className:"results-container",children:[t.map((function(e){return Object(O.jsx)(K,{album:e},e.collectionId)})),";"]})]})}},{key:"render",value:function(){var e=this.state,t=e.searchInput,n=e.loading,a=e.request;return Object(O.jsxs)("div",{"data-testid":"page-search",children:[Object(O.jsx)(C,{}),Object(O.jsx)("div",{className:"search",children:Object(O.jsxs)("div",{className:"search-container",children:[Object(O.jsx)("input",{className:"search__input","data-testid":"search-artist-input",type:"text",value:t,onChange:this.handleChange}),Object(O.jsx)("button",{className:"search__button","data-testid":"search-artist-button",type:"button",disabled:t.length<2,onClick:this.onSearch,children:"Search"})]})}),n?Object(O.jsx)(g,{}):Object(O.jsx)(O.Fragment,{children:Object(O.jsx)("div",{children:a&&this.renderAlbums()})})]})}}]),n}(a.Component),R=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(O.jsx)("div",{"data-testid":"page-not-found",children:"Error 404 - Page Not Found"})}}]),n}(a.Component),z=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={user:"",loading:!0},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=Object(p.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.user();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"user",value:function(){var e=Object(p.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:t=e.sent,this.setState({user:t,loading:!1});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.user;return Object(O.jsxs)("div",{"data-testid":"page-profile",children:[Object(O.jsx)(C,{}),Object(O.jsx)("div",{className:"profile",children:t?Object(O.jsx)(g,{}):Object(O.jsxs)("div",{className:"profile__box",children:[Object(O.jsx)("img",{onError:function(e){return e.target.style.display="none"},"data-testid":"profile-image",src:n.image,alt:n.name}),Object(O.jsx)("p",{children:n.name}),Object(O.jsx)("p",{children:n.email}),Object(O.jsx)("p",{children:n.description}),Object(O.jsx)(d.b,{className:"edit",to:"/profile/edit",children:"Editar perfil"})]})})]})}}]),n}(a.Component),G=n(18),H=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).handleChange=function(t){var n=t.target,a=n.name;e.setState((function(){return Object(G.a)({},a,n.value)}),(function(){e.checkButton()}))},e.checkButton=function(){var t=!0,n=e.state,a=n.name,r=n.email,i=n.image,c=n.description;a.length&&i.length&&c.length&&r.length>0&&(t=!1),r.includes("@")||(t=!0),e.setState({isSaveButtonDisabled:t})},e.state={loading:!1,name:"",email:"",image:"",description:"",isSaveButtonDisabled:!1,redirect:!1},e.checkButton=e.checkButton.bind(Object(f.a)(e)),e.saveUser=e.saveUser.bind(Object(f.a)(e)),e.loadUser=e.loadUser.bind(Object(f.a)(e)),e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.loadUser()}},{key:"saveUser",value:function(){var e,t=this.state,n=t.name,a=t.email,r=t.image,i=t.description;this.setState({loading:!0}),e={name:n,email:a,image:r,description:i},new Promise((function(t){k(Object(j.a)({},e)),y("OK")(t)})),this.setState({loading:!1,redirect:!0})}},{key:"loadUser",value:function(){var e=Object(p.a)(m.a.mark((function e(){var t=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,S().then((function(e){var n=e.name,a=e.email,r=e.description,i=e.image;return t.setState({name:n,email:a,description:r,image:i})}));case 3:this.setState({loading:!1});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.image,n=e.name,a=e.email,r=e.description,i=e.isSaveButtonDisabled,c=e.loading;return e.redirect?Object(O.jsx)(h.a,{to:"/profile"}):Object(O.jsxs)("div",{"data-testid":"page-profile-edit",children:[Object(O.jsx)(C,{}),Object(O.jsx)("div",{className:"profile-edit",children:Object(O.jsxs)("div",{className:"profile-edit__box",children:[c?Object(O.jsx)(g,{}):null,Object(O.jsxs)("label",{htmlFor:"image",children:["Imagem",Object(O.jsx)("input",{className:"edit-input","data-testid":"edit-input-image",id:"image",name:"image",value:t,onChange:this.handleChange})]}),Object(O.jsxs)("label",{htmlFor:"name",children:["Nome",Object(O.jsx)("input",{className:"edit-input","data-testid":"edit-input-name",id:"name",name:"name",type:"text",value:n,onChange:this.handleChange})]}),Object(O.jsxs)("label",{htmlFor:"email",children:["Email",Object(O.jsx)("input",{className:"edit-input","data-testid":"edit-input-email",id:"email",name:"email",type:"email",value:a,onChange:this.handleChange})]}),Object(O.jsxs)("label",{htmlFor:"description",children:["Description",Object(O.jsx)("textarea",{className:"edit-input","data-testid":"edit-input-description",id:"description",name:"description",type:"text",value:r,onChange:this.handleChange})]}),Object(O.jsx)("button",{className:"login__button",type:"button","data-testid":"edit-button-save",onClick:this.saveUser,disabled:i,children:"salvar"})]})})]})}}]),n}(a.Component),L=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(O.jsx)(d.a,{children:Object(O.jsxs)(h.d,{children:[Object(O.jsx)(h.b,{exact:!0,path:"/",component:T}),Object(O.jsx)(h.b,{path:"/search",component:q}),Object(O.jsx)(h.b,{path:"/album/:id",component:J}),Object(O.jsx)(h.b,{path:"/favorites",component:E}),Object(O.jsx)(h.b,{path:"/profile/edit",component:H}),Object(O.jsx)(h.b,{path:"/profile",component:z}),Object(O.jsx)(h.b,{path:"/*",component:R})]})})}}]),n}(r.a.Component);c.a.render(Object(O.jsx)(r.a.StrictMode,{children:Object(O.jsx)(L,{})}),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.a4271bc3.chunk.js.map